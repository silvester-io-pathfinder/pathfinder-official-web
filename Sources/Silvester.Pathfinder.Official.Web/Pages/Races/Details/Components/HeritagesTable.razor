@using Silvester.Pathfinder.Official.Web.Shared.Preferences;
@using Silvester.Pathfinder.Official.Web.Shared.Cards;
@using Silvester.Pathfinder.Official.Web.Shared.Tables;
@using Silvester.Pathfinder.Official.Web.Pages.Traits.Details.Components;

<div>
    @if (Race == null)
    {

    }
    else
    {
        <RelationshipTable TEntity="IGetRaceById_Races_Items_Heritages" DefaultSortLabel="@nameof(IGetRaceById_Races_Items_Heritages.Name)" Filter="@HeritageFilter" InspectionUrl="@((e) => $"/heritages/{e.Id}")" Items="@(() => Race.Heritages)">
            <Columns>
                <MudTh><MudTableSortLabel SortLabel="@nameof(IGetRaceById_Races_Items_Heritages.Name)" T="IGetRaceById_Races_Items_Heritages" InitialDirection="SortDirection.Ascending">Name</MudTableSortLabel></MudTh>
                <MudTh><MudTableSortLabel SortLabel="@(nameof(IGetRaceById_Races_Items_Heritages.Rarity) + ".Name")" T="IGetRaceById_Races_Items_Heritages">Rarity</MudTableSortLabel></MudTh>
                <MudTh><MudTableSortLabel SortLabel="@nameof(IGetRaceById_Races_Items_Heritages.Description)" T="IGetRaceById_Races_Items_Heritages">Description</MudTableSortLabel></MudTh>
            </Columns>
            <Rows>
                <MudTd Style="font-weight: 500;">@context.Name</MudTd>
                <MudTd>@context.Rarity.Name</MudTd>
                <MudTdEllipsized Text="@context.Description" />
            </Rows>
        </RelationshipTable>
    }
</div>

@code
{
    [Parameter]
    public IGetRaceById_Races_Items Race { get; set; } = default!;

    public bool HeritageFilter(IGetRaceById_Races_Items_Heritages heritage, string searchString)
    {
        return heritage.Name.ToLower().Contains(searchString)
            || heritage.Description.ToLower().Contains(searchString)
            || heritage.Rarity.Name.ToLower().Contains(searchString);
    }
}