@using Silvester.Pathfinder.Official.Web.Shared.Preferences;
@using Silvester.Pathfinder.Official.Web.Shared.Tables;

<div>
    <PreferenceCategory Title="Description">
        <PreferenceItemText Text="@DivineFont.Description" />
    </PreferenceCategory>
    <MudDivider />
    <RelationshipTable TEntity="IGetDivineFonts_DivineFonts_Items_Deities" DefaultSortLabel="@nameof(IGetDivineFonts_DivineFonts_Items_Deities.Name)" Filter="@DeityFilter" InspectionUrl="@((e) => $"deities/{e.Id}")" Items="@(() => DivineFont.Deities)">
        <Columns>
            <MudTh><MudTableSortLabel SortLabel="@nameof(IGetDivineFonts_DivineFonts_Items_Deities.Name)" T="IGetDivineFonts_DivineFonts_Items_Deities" InitialDirection="SortDirection.Ascending">Name</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortLabel="@nameof(IGetDivineFonts_DivineFonts_Items_Deities.Description)" T="IGetDivineFonts_DivineFonts_Items_Deities">Description</MudTableSortLabel></MudTh>
        </Columns>
        <Rows>
            <MudTd Style="font-weight: 500;">@context.Name</MudTd>
            <MudTdEllipsized Text="@context.Description" />
        </Rows>
    </RelationshipTable>
</div>

@code {
    [Parameter]
    public IGetDivineFonts_DivineFonts_Items DivineFont { get; set; } = default!;

    public bool DeityFilter(IGetDivineFonts_DivineFonts_Items_Deities deity, string searchString)
    {
        return deity.Name.ToLower().Contains(searchString)
            || deity.Description.ToLower().Contains(searchString);
    }
}
